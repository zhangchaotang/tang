{"remainingRequest":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue","mtime":1573195667376},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcE11dGF0aW9ucyB9IGZyb20gJ3Z1ZXgnCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHNsaWRlc2hvd0xpc3Q6IFtdLAogICAgICBnb29kc0NsYXNzZXM6IFtdLAogICAgICBnb29kc0xpc3RzOiBbXSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwKICAgICAgcGFnZTogMSwKICAgICAgcGVyX3BhZ2U6IDIwCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBNdXRhdGlvbnMoWydjYXJ0TnVtQ2hhbmdlJ10pLAogICAgb25Mb2FkICgpIHsKICAgICAgLy8g6LCD55So5o6l5Y+j6I635Y+W6aaW6aG15ZWG5ZOB5YiX6KGoCiAgICAgIHRoaXMuJGh0dHAKICAgICAgICAuZ2V0KGAvaW5kZXhfZ29vZHM/cGFnZT0ke3RoaXMucGFnZX0mcGVyX3BhZ2U9JHt0aGlzLnBlcl9wYWdlfWApCiAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuZ29vZHNMaXN0cyA9IHRoaXMuZ29vZHNMaXN0cy5jb25jYXQocmVzLmRhdGEuZGF0YSkKICAgICAgICAgIC8vIOWKoOi9veeKtuaAgee7k+adnwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgIHRoaXMucGFnZSsrCiAgICAgICAgICAvLyDmlbDmja7lhajpg6jliqDovb3lrozmiJAKICAgICAgICAgIGlmIChyZXMuZGF0YS5kYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZQogICAgICAgICAgfQogICAgICAgIH0pCiAgICB9LAogICAgYWRkQ2FydCAoaWQpIHsKICAgICAgbGV0IGFkZENhcnRMaXN0ID0gW3sgaWQ6IGlkLCBudW06IDEsIGlzY2hlY2tlZDogZmFsc2UgfV0KICAgICAgbGV0IGNhcnRMaXN0ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYXJ0TGlzdCcpCiAgICAgIGlmIChjYXJ0TGlzdCA9PT0gbnVsbCkgewogICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FydExpc3QnLCBKU09OLnN0cmluZ2lmeShhZGRDYXJ0TGlzdCkpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FydExpc3QgPSBKU09OLnBhcnNlKGNhcnRMaXN0KQogICAgICAgIGxldCBpbmRleCA9IGNhcnRMaXN0LmZpbmRJbmRleChpdGVtID0+IHsKICAgICAgICAgIHJldHVybiBpdGVtLmlkID09PSBhZGRDYXJ0TGlzdFswXS5pZAogICAgICAgIH0pCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgY2FydExpc3RbaW5kZXhdLm51bSsrCiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMaXN0JywgSlNPTi5zdHJpbmdpZnkoY2FydExpc3QpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBjYXJ0TGlzdCA9CiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMaXN0JywgSlNPTi5zdHJpbmdpZnkoY2FydExpc3QuY29uY2F0KGFkZENhcnRMaXN0KSkpCiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY2FydE51bUNoYW5nZShKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FydExpc3QnKSkubGVuZ3RoKQogICAgfQogIH0sCiAgY3JlYXRlZCAoKSB7CiAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bova7mkq3lm77mlbDmja4KICAgIHRoaXMuJGh0dHAuZ2V0KCcvbWFpbl9hZF9pbWFnZXMnKS50aGVuKHJlcyA9PiB7CiAgICAgIHRoaXMuc2xpZGVzaG93TGlzdCA9IHJlcy5kYXRhLmRhdGEKICAgIH0pCiAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bpppbpobXllYblk4HmjqjojZDliIbnsbsKICAgIHRoaXMuJGh0dHAuZ2V0KCcvaW5kZXhfY2F0ZWdvcmllcycpLnRoZW4ocmVzID0+IHsKICAgICAgdGhpcy5nb29kc0NsYXNzZXMgPSByZXMuZGF0YS5kYXRhCiAgICB9KQogIH0KfQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- 图片轮播图 -->\n    <van-row>\n      <van-swipe :autoplay=\"3000\" indicator-color=\"white\">\n        <van-swipe-item v-for=\"item in slideshowList\" :key=\"item.id\">\n          <van-image height=\"10rem\" fit=\"contain\" :src=\"item.image\" :to=\"item.link\" />\n        </van-swipe-item>\n      </van-swipe>\n    </van-row>\n    <!-- 推荐分类 -->\n    <van-row>\n      <van-grid :column-num=\"4\">\n        <van-grid-item v-for=\"item in goodsClasses\" :key=\"item.id\" :text=\"item.cat_name\" />\n      </van-grid>\n    </van-row>\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\n      <!-- 商品列表 -->\n      <van-row class=\"goodsList\" gutter=\"20\">\n        <van-col v-for=\"item in goodsLists\" :key=\"item.id\" :span=\"10\" class=\"goods_item\">\n          <van-image width=\"100\" height=\"100\" :src=\"item.image\" />\n          <div class=\"van-ellipsis goods_text\">{{item.goods_name}}</div>\n          <van-button type=\"warning\" size=\"small\" @click=\"addCart(item.id)\">加入购物车</van-button>\n          <p class=\"goods_price\">&yen;{{item.price}}</p>\n        </van-col>\n      </van-row>\n    </van-list>\n  </div>\n</template>\n\n<script>\nimport { mapMutations } from 'vuex'\nexport default {\n  data () {\n    return {\n      slideshowList: [],\n      goodsClasses: [],\n      goodsLists: [],\n      loading: false,\n      finished: false,\n      page: 1,\n      per_page: 20\n    }\n  },\n  methods: {\n    ...mapMutations(['cartNumChange']),\n    onLoad () {\n      // 调用接口获取首页商品列表\n      this.$http\n        .get(`/index_goods?page=${this.page}&per_page=${this.per_page}`)\n        .then(res => {\n          this.goodsLists = this.goodsLists.concat(res.data.data)\n          // 加载状态结束\n          this.loading = false\n          this.page++\n          // 数据全部加载完成\n          if (res.data.data.length === 0) {\n            this.finished = true\n          }\n        })\n    },\n    addCart (id) {\n      let addCartList = [{ id: id, num: 1, ischecked: false }]\n      let cartList = window.localStorage.getItem('cartList')\n      if (cartList === null) {\n        window.localStorage.setItem('cartList', JSON.stringify(addCartList))\n      } else {\n        cartList = JSON.parse(cartList)\n        let index = cartList.findIndex(item => {\n          return item.id === addCartList[0].id\n        })\n        if (index !== -1) {\n          cartList[index].num++\n          window.localStorage.setItem('cartList', JSON.stringify(cartList))\n        } else {\n          // cartList =\n          window.localStorage.setItem('cartList', JSON.stringify(cartList.concat(addCartList)))\n        }\n      }\n      this.cartNumChange(JSON.parse(window.localStorage.getItem('cartList')).length)\n    }\n  },\n  created () {\n    // 调用接口获取轮播图数据\n    this.$http.get('/main_ad_images').then(res => {\n      this.slideshowList = res.data.data\n    })\n    // 调用接口获取首页商品推荐分类\n    this.$http.get('/index_categories').then(res => {\n      this.goodsClasses = res.data.data\n    })\n  }\n}\n</script>\n\n<style>\n.home {\n  padding-bottom: 80px;\n}\n.goodsList {\n  padding: 20px 60px;\n}\n.goods_item {\n  text-align: center;\n  margin-bottom: 20px;\n}\n\n.goods_item:nth-child(even) {\n  margin-left: 30px;\n}\n.goods_text {\n  margin: 10px 0;\n}\n.goods_price {\n  margin: 0;\n  padding: 5px 0;\n  color: red;\n}\n</style>\n"]}]}